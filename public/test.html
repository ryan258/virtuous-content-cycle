<!DOCTYPE html>
<html>
<head>
    <title>API Test</title>
</head>
<body>
    <h1>API Connection Test</h1>
    <button onclick="testConnection()">Test Connection</button>
    <pre id="result"></pre>

    <script>
        async function testConnection() {
            const result = document.getElementById('result');
            result.textContent = 'Testing...';

            try {
                // Test 1: Health check
                const healthResponse = await fetch('http://localhost:3000/health');
                const healthText = await healthResponse.text();
                result.textContent = `Health check: ${healthText}\n`;

                // Test 2: Create content
                const createResponse = await fetch('http://localhost:3000/api/content/create', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        originalInput: "Test content from browser",
                        metadata: {
                            contentType: "test",
                            targetAudience: "developers",
                            maxCycles: 5,
                            convergenceThreshold: 0.8,
                            focusGroupConfig: {
                                targetMarketCount: 3,
                                randomCount: 2
                            }
                        }
                    })
                });

                if (!createResponse.ok) {
                    const error = await createResponse.json();
                    throw new Error(JSON.stringify(error, null, 2));
                }

                const createData = await createResponse.json();
                result.textContent += `\nCreate content: SUCCESS\nContent ID: ${createData.id}`;
            } catch (error) {
                result.textContent += `\nERROR: ${error.message}`;
                console.error('Full error:', error);
            }
        }
    </script>
</body>
</html>
